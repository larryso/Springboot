package com.larry.modules.security.utils;

import java.util.Random;

public class VerificationCodeUtils {
	// 使用到Algerian字体，系统里没有的话需要安装字体，字体只显示大写，去掉了1,0,i,o几个容易混淆的字符
	public static final String VERIFY_CODES = "23456789ABCDEFGHJKLMNPQRSTUVWXYZ";
	//private static Random random = new Random();

	public static String generateVerifyCode(int verifySize) {
		return generateVerificationCode(verifySize, VERIFY_CODES);
	}

	public static String generateVerificationCode(int verifySize, String source) {
		if(source == null || "".equals(source)) {
			source = VERIFY_CODES;
		}
		int codeLength = source.length();
		Random random = new Random(System.currentTimeMillis());
		StringBuilder verifyCode = new StringBuilder(verifySize);
		for(int i=0;i<verifySize;i++) {
			verifyCode.append(source.charAt(random.nextInt(codeLength-1)));
		}
		return verifyCode.toString();
	}
}
